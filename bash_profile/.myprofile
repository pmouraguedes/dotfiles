#!/usr/bin/env bash

source ~/.bash_git

export PS1='\[\e]0;\u@\h:\w\a\]\u@\h \[\e[32m\]\w \[\e[91m\]$(__git_ps1)\[\e[00m\]$ '
export VISUAL="nvim"
export EDITOR="$VISUAL"
export SUDO_EDITOR="$VISUAL"
export MANPAGER='nvim +Man!'
export TERM=xterm

# when the remote host does not set PS1, this falls back to the ssh command
set-title() { echo -ne "\033]0;$*\007"; }
ssh() {
    ssh_cmd="ssh $*"
    echo -ne "\033]0;${ssh_cmd}\007"
    /usr/bin/ssh "$@"
    echo -ne "\033]0;${USER}@${HOSTNAME}:$(pwd) $(__git_ps1)\007"
}

# bind -m vi-insert '"jj": vi-movement-mode'
# set -o vi

# main nvim
alias v='nvim'
# nvim in terminal mode
alias vt='nvim -c "terminal" -c "wincmd o"'
# open a scratch buffer
alias vs='cd ~/tmp && nvim -c "bd" "bd"'

# other nvim configurations
alias vv='JAVA_HOME=/usr/lib/jvm/java-1.21.0-openjdk-amd64 NVIM_APPNAME="nvim-lazy" nvim' # custom lazyvim
alias vm='NVIM_APPNAME=nvim-minimax nvim'                        # minimax
alias v2='NVIM_APPNAME="nvim2" nvim'
alias v3='NVIM_APPNAME="nvim3" nvim'

unset GTK_IM_MODULE
unset QT_IM_MODULE

alias mi="make && sudo make install"

# Golang - need for neotest-golang, cause it uses the -race option by default
export CGO_ENABLED=1

# Maven
alias gi="gmvn install"
alias gci="gmvn clean install -T 8C"
# alias gcit="gmvn clean install -DskipTests"
alias gcit="gmvn clean install -P test"
alias gcidb="gmvn clean install -Pinitdb"
alias gp="gmvn package -Pbundle"
alias gcp="gmvn clean package -Pbundle"
alias gt="gmvn test -DfailIfNoTests=false"
# alias git="gmvn verify -Pintegration-test"
# alias mc="gmvn clean && find . -mindepth 1 -maxdepth 2 -type d -name state -print0 | xargs -0 -I {} rm -rf {} +"
# alias gc="gmvn compile"
# alias gcc="gmvn clean compile"

export MAVEN_OPTS="-Xms128m -Xmx1024m"

# Java
export JAVA_OPTS="-Xms128m -Xmx512m"

export PATH=~/go/bin:~/software/flutter/bin:~/.npm-global/bin:$PATH
export PATH=~/bin:~/software/idea/bin:$PATH
export PATH=~/dotfiles/scripts:$PATH
export PATH=~/gebit-dotfiles/scripts:$PATH

# export NVM_DIR="$HOME/.nvm"
# [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm

# [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion" # This loads nvm bash_completion

# Set up fzf key bindings and fuzzy completion
# eval "$(fzf --bash)"

# eza_params=('--git' '--icons' '--classify' '--group-directories-first' '--time-style=long-iso' '--group' '--color-scale')

# alias l='eza $eza_params'
# #alias l='eza --git-ignore $eza_params'
# alias ll='eza --all --header --long $eza_params'
alias ll='ls -lah'
# alias llm='eza --all --header --long --sort=modified $eza_params'
# alias la='eza -lbhHigUmuSa'
# alias lx='eza -lbhHigUmuSa@'
# alias lt='eza --tree $eza_params'
# alias tree='eza --tree $eza_params'

alias cat='bat'
# alias fd='fdfind'

alias cdprojects='cd ~/projects'
alias cdnotes='cd ~/Dropbox/slug/PMG/notes/Obsidian'
alias cdaldi='cd ~/dev/aldi/'
alias cddb='cd /home/pguedes/.local/share/nvim/dadbod_ui'
alias cddwm='cd ~/software/dwm/ && nvim'
alias cdblocks='cd ~/software/dwmblocks/ && nvim'
alias q='exit'
alias ..='cd ..'
alias c='clear'

alias lg='lazygit'
alias ldo='lazydocker'
alias open='xdg-open'

# export JAVA_HOME="/usr/lib/jvm/java-1.17.0-openjdk-amd64"
export JAVA_HOME="/usr/lib/jvm/java-17-openjdk"

# Tomcat
#export CATALINA_HOME="/Library/Tomcat"
#export CATALINA_BASE="/Library/Tomcat"
#export CATALINA_OPTS="-Xms128m -Xmx512m"

# The next line updates PATH for the Google Cloud SDK.
if [ -f '/home/pguedes/software/google-cloud-sdk/path.bash.inc' ]; then . '/home/pguedes/software/google-cloud-sdk/path.bash.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/home/pguedes/software/google-cloud-sdk/completion.bash.inc' ]; then . '/home/pguedes/software/google-cloud-sdk/completion.bash.inc'; fi

# GEBIT

export COMPOSE_PROFILES=linux

[ -f "$HOME/gebit-dotfiles/scripts/dev-misc" ] && source "$HOME/gebit-dotfiles/scripts/dev-misc"
[ -f "$HOME/gebit-dotfiles/scripts/mounttestlab" ] && source "$HOME/gebit-dotfiles/scripts/mounttestlab"

# java and dwm
export _JAVA_AWT_WM_NONREPARENTING=1
export AWT_TOOLKIT=MToolkit

[ -f "$HOME/.atuin/bin/env" ] && . "$HOME/.atuin/bin/env"

[[ -f ~/.bash-preexec.sh ]] && source ~/.bash-preexec.sh
[ -f "$HOME/.atuin/bin/env" ] && eval "$(atuin init bash --disable-up-arrow)"

source /usr/share/doc/pkgfile/command-not-found.bash
